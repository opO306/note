import{r as t,j as e,R}from"./index-BbQUyxS2.js";import{b as O,i as P,k as E,l as F,m as b,n as W,O as $,o as D,M as H}from"./MainScreenRefactored-BV6t3nIm.js";import{B as V,g as k}from"./App-CSSMO0Oh.js";import{C as w,a as C}from"./card-3DnD1VWg.js";import{I as _}from"./input-BSsz_4de.js";import{A as q}from"./arrow-left-2FIjscO0.js";import{S as y}from"./search-UcxyXlk4.js";import"./vendor-capacitor-B-BXHHKA.js";import"./vendor-react-1wgkHQEd.js";import"./vendor-firebase-C-5pmDAC.js";import"./toastHelper-C2J_DWXH.js";import"./index-5LAPAtmD.js";import"./index-3nZT1wFB.js";import"./checkbox-CPLuEh_8.js";import"./check-C_WT1q55.js";import"./avatar-CLeAy6nm.js";import"./alert-dialog-simple-C_DV6hbj.js";import"./sparkles-Bmu-kJOd.js";import"./firebaseCache-C_csZa1c.js";import"./profanityFilter-CmEWjjlv.js";import"./users-BnxKf8TP.js";import"./sun-ay515dC2.js";function ge({onBack:s,bookmarkedPosts:a,posts:o,onPostSelect:c,userNickname:d,currentTitle:u,isGuest:x}){const[h,f]=t.useState(""),j=t.useDeferredValue(h),[p,A]=t.useState(!1),S=O({key:"bookmarks"}),l=t.useMemo(()=>o.filter(r=>r.hidden!==!0),[o]),M=t.useMemo(()=>Array.from(new Set(l.map(r=>r.authorUid).filter(r=>typeof r=="string"&&r.length>0))),[l]),L=P(M),n=t.useMemo(()=>l.filter(r=>a.has(String(r.id))),[l,a]),m=t.useMemo(()=>j.trim().toLowerCase(),[j]),T=t.useMemo(()=>n.filter(r=>{if(!m)return!0;const i=r.title?.toLowerCase()??"",g=r.content?.toLowerCase()??"",U=r.author?.toLowerCase()??"";return i.includes(m)||g.includes(m)||U.includes(m)}),[n,m]);t.useEffect(()=>{(n.length>0||l.length>0)&&A(!0)},[n.length,l.length]);const{visible:N}=E(T,!p&&a.size>0&&l.length===0),z=t.useCallback(r=>{f(r.target.value)},[]),v=t.useMemo(()=>new Map(l.map(r=>[r.id,r])),[l]),B=t.useCallback(r=>{const i=v.get(r);i&&c(i)},[v,c]),I=t.useCallback(r=>F(r,d,u),[d,u]);return e.jsxs("div",{className:"w-full h-full bg-background text-foreground flex flex-col",children:[e.jsx("header",{className:"bg-card/95 backdrop-blur-xl border-b border-border flex-shrink-0 safe-top",children:e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(V,{variant:"ghost",size:"icon",onClick:s,children:e.jsx(q,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{className:"w-5 h-5 text-primary"}),e.jsx("h1",{className:"font-medium",children:"북마크"})]}),e.jsxs(k,{variant:"secondary",className:"ml-auto",children:[n.length,"개"]})]})})}),e.jsx("div",{className:"border-b border-border p-4 flex-shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(_,{placeholder:"북마크한 글 검색...",value:h,onChange:z,className:"pl-10"})]})}),e.jsx("div",{ref:S,className:"flex-1 scroll-container",children:!p&&a.size>0&&o.length===0?e.jsx("div",{className:"p-4 pb-24 space-y-3",children:Array.from({length:4}).map((r,i)=>e.jsx(w,{className:"border border-border/60 bg-card/60",children:e.jsxs(C,{className:"p-4 space-y-3 animate-pulse",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-muted/50"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-3 w-1/3 bg-muted/50 rounded"}),e.jsx("div",{className:"h-3 w-1/4 bg-muted/40 rounded"})]})]}),e.jsx("div",{className:"h-4 w-3/4 bg-muted/40 rounded"}),e.jsx("div",{className:"h-3 w-full bg-muted/30 rounded"})]})},i))}):N.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center h-full p-8",children:e.jsx("div",{className:"text-center space-y-4",children:n.length===0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("div",{className:"absolute inset-0 bg-blue-500/30 dark:bg-blue-400/30 blur-2xl rounded-full"}),e.jsx("div",{className:"relative w-24 h-24 rounded-full bg-blue-100 dark:bg-blue-900/40 flex items-center justify-center border-4 border-blue-400 dark:border-blue-600 shadow-lg mx-auto",children:e.jsx(b,{className:"w-14 h-14 text-blue-900 dark:text-blue-200",strokeWidth:2.5})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"북마크한 글이 없습니다"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"관심 있는 글들을 북마크해서 나중에 다시 읽어보세요"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-500/30 dark:bg-slate-400/30 blur-2xl rounded-full"}),e.jsx("div",{className:"relative w-24 h-24 rounded-full bg-slate-100 dark:bg-slate-700/40 flex items-center justify-center border-4 border-slate-400 dark:border-slate-600 shadow-lg mx-auto",children:e.jsx(y,{className:"w-14 h-14 text-slate-900 dark:text-slate-200",strokeWidth:2.5})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"검색 결과가 없습니다"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"다른 검색어를 시도해보세요"})]})]})})}):e.jsx("div",{className:"p-4 pb-24 space-y-3",children:N.map(r=>{const i=r.authorUid,g=i?L[i]:void 0;return e.jsx(G,{post:r,onSelect:B,getAuthorTitle:I,authorProfile:g,isGuest:x},r.id)})})})]})}const G=R.memo(({post:s,onSelect:a,getAuthorTitle:o,authorProfile:c,isGuest:d})=>{const u=t.useCallback(()=>{a(s.id)},[a,s.id]),x=o(s.author),h=t.useMemo(()=>c?.profileImage??W(s.authorAvatar)??"",[c?.profileImage,s.authorAvatar]);return e.jsx(w,{className:"border-border/60 shadow-sm bg-card/80 backdrop-blur-sm hover:shadow-md transition-shadow cursor-pointer list-optimized",onClick:u,children:e.jsx(C,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[e.jsx($,{src:h||void 0,alt:s.author?`${s.author}님의 프로필`:"프로필 이미지",nickname:s.author,fallbackText:s.author?.charAt(0)?.toUpperCase()||"?",className:"ring-2 ring-border/20",size:40,loading:"lazy",decoding:"async"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.author}),x&&e.jsx(k,{variant:"secondary",className:"text-[10px] px-2 py-0.5 h-auto bg-primary/10 text-primary border-primary/20",children:x})]}),e.jsx("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground mt-1",children:(s.timeAgo||s.createdAtText)&&e.jsx("span",{title:s.createdAtText||s.category,children:s.timeAgo??s.createdAtText})}),(()=>{const f=[s.category&&s.category!=="전체"?s.category:null,s.subCategory&&s.subCategory!=="전체"?s.subCategory:null,s.type?s.type==="guide"?"길잡이 글":"질문글":null].filter(Boolean);return f.length?e.jsx("div",{className:"text-xs text-muted-foreground mt-2",children:f.join(" · ")}):null})()]})]}),e.jsx(b,{className:"w-4 h-4 fill-amber-500 text-amber-500",onClick:d?()=>{}:void 0,style:d?{cursor:"not-allowed"}:void 0})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-base mb-1 line-clamp-1",children:s.title}),s.content&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.content})]}),e.jsx("div",{className:"flex items-center justify-between pt-1",children:e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(D,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{children:s.lanterns??0})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{children:s.comments??0})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"w-1 h-1 rounded-full bg-muted-foreground/60 inline-block"}),e.jsxs("span",{children:[s.views??0," 조회"]})]})]})})]})})})},(s,a)=>{if(s.post.id!==a.post.id||s.post.title!==a.post.title||s.post.content!==a.post.content||s.post.author!==a.post.author||s.post.authorAvatar!==a.post.authorAvatar||s.authorProfile?.profileImage!==a.authorProfile?.profileImage||s.post.timeAgo!==a.post.timeAgo||s.post.category!==a.post.category||s.post.type!==a.post.type||s.post.lanterns!==a.post.lanterns||s.post.comments!==a.post.comments)return!1;const o=s.post.tags?.join(",")??"",c=a.post.tags?.join(",")??"";return o===c});export{ge as BookmarkScreen};
