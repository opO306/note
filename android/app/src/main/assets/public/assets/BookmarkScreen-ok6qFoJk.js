import{r as t,j as e,R as U}from"./index-BJjkZhAE.js";import{u as R,j as O,l as P,m as E,B as F,f as W,n as b,k as y,I as $,C as k,b as w,o as q,O as D,p as G,q as H}from"./App-Cnx-z95_.js";import{S as v}from"./search-CuXXKiqy.js";import"./vendor-capacitor-Bm7NWSxP.js";import"./vendor-react-1wgkHQEd.js";import"./vendor-firebase-B8qz7irO.js";function Z({onBack:s,bookmarkedPosts:r,posts:c,onPostSelect:n,userNickname:u,currentTitle:o}){const[x,h]=t.useState(""),g=t.useDeferredValue(x),[j,C]=t.useState(!1),A=R({key:"bookmarks"}),l=t.useMemo(()=>c.filter(a=>a.hidden!==!0),[c]),S=t.useMemo(()=>Array.from(new Set(l.map(a=>a.authorUid).filter(a=>typeof a=="string"&&a.length>0))),[l]),L=O(S),d=t.useMemo(()=>l.filter(a=>r.has(String(a.id))),[l,r]),m=t.useMemo(()=>g.trim().toLowerCase(),[g]),M=t.useMemo(()=>d.filter(a=>{if(!m)return!0;const i=a.title?.toLowerCase()??"",f=a.content?.toLowerCase()??"",I=a.author?.toLowerCase()??"";return i.includes(m)||f.includes(m)||I.includes(m)}),[d,m]);t.useEffect(()=>{(d.length>0||l.length>0)&&C(!0)},[d.length,l.length]);const{visible:p}=P(M,!j&&r.size>0&&l.length===0),T=t.useCallback(a=>{h(a.target.value)},[]),N=t.useMemo(()=>new Map(l.map(a=>[a.id,a])),[l]),z=t.useCallback(a=>{const i=N.get(a);i&&n(i)},[N,n]),B=t.useCallback(a=>E(a,u,o),[u,o]);return e.jsxs("div",{className:"w-full h-full bg-background text-foreground flex flex-col",children:[e.jsx("header",{className:"bg-card/95 backdrop-blur-xl border-b border-border flex-shrink-0 safe-top",children:e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(F,{variant:"ghost",size:"icon",onClick:s,children:e.jsx(W,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{className:"w-5 h-5 text-primary"}),e.jsx("h1",{className:"font-medium",children:"북마크"})]}),e.jsxs(y,{variant:"secondary",className:"ml-auto",children:[d.length,"개"]})]})})}),e.jsx("div",{className:"border-b border-border p-4 flex-shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx(v,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx($,{placeholder:"북마크한 글 검색...",value:x,onChange:T,className:"pl-10"})]})}),e.jsx("div",{ref:A,className:"flex-1 scroll-container",children:!j&&r.size>0&&c.length===0?e.jsx("div",{className:"p-4 pb-24 space-y-3",children:Array.from({length:4}).map((a,i)=>e.jsx(k,{className:"border border-border/60 bg-card/60",children:e.jsxs(w,{className:"p-4 space-y-3 animate-pulse",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-muted/50"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-3 w-1/3 bg-muted/50 rounded"}),e.jsx("div",{className:"h-3 w-1/4 bg-muted/40 rounded"})]})]}),e.jsx("div",{className:"h-4 w-3/4 bg-muted/40 rounded"}),e.jsx("div",{className:"h-3 w-full bg-muted/30 rounded"})]})},i))}):p.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center h-full p-8",children:e.jsx("div",{className:"text-center space-y-4",children:d.length===0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("div",{className:"absolute inset-0 bg-blue-500/30 dark:bg-blue-400/30 blur-2xl rounded-full"}),e.jsx("div",{className:"relative w-24 h-24 rounded-full bg-blue-100 dark:bg-blue-900/40 flex items-center justify-center border-4 border-blue-400 dark:border-blue-600 shadow-lg mx-auto",children:e.jsx(b,{className:"w-14 h-14 text-blue-900 dark:text-blue-200",strokeWidth:2.5})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"북마크한 글이 없습니다"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"관심 있는 글들을 북마크해서 나중에 다시 읽어보세요"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-500/30 dark:bg-slate-400/30 blur-2xl rounded-full"}),e.jsx("div",{className:"relative w-24 h-24 rounded-full bg-slate-100 dark:bg-slate-700/40 flex items-center justify-center border-4 border-slate-400 dark:border-slate-600 shadow-lg mx-auto",children:e.jsx(v,{className:"w-14 h-14 text-slate-900 dark:text-slate-200",strokeWidth:2.5})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"검색 결과가 없습니다"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"다른 검색어를 시도해보세요"})]})]})})}):e.jsx("div",{className:"p-4 pb-24 space-y-3",children:p.map(a=>{const i=a.authorUid,f=i?L[i]:void 0;return e.jsx(V,{post:a,onSelect:z,getAuthorTitle:B,authorProfile:f},a.id)})})})]})}const V=U.memo(({post:s,onSelect:r,getAuthorTitle:c,authorProfile:n})=>{const u=t.useCallback(()=>{r(s.id)},[r,s.id]),o=c(s.author),x=t.useMemo(()=>n?.profileImage??q(s.authorAvatar)??"",[n?.profileImage,s.authorAvatar]);return e.jsx(k,{className:"border-border/60 shadow-sm bg-card/80 backdrop-blur-sm hover:shadow-md transition-shadow cursor-pointer list-optimized",onClick:u,children:e.jsx(w,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[e.jsx(D,{src:x||void 0,alt:s.author?`${s.author}님의 프로필`:"프로필 이미지",nickname:s.author,fallbackText:s.author?.charAt(0)?.toUpperCase()||"?",className:"ring-2 ring-border/20",size:40,loading:"lazy",decoding:"async"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.author}),o&&e.jsx(y,{variant:"secondary",className:"text-[10px] px-2 py-0.5 h-auto bg-primary/10 text-primary border-primary/20",children:o})]}),e.jsx("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground mt-1",children:(s.timeAgo||s.createdAtText)&&e.jsx("span",{title:s.createdAtText||s.category,children:s.timeAgo??s.createdAtText})}),(()=>{const h=[s.category&&s.category!=="전체"?s.category:null,s.subCategory&&s.subCategory!=="전체"?s.subCategory:null,s.type?s.type==="guide"?"길잡이 글":"질문글":null].filter(Boolean);return h.length?e.jsx("div",{className:"text-xs text-muted-foreground mt-2",children:h.join(" · ")}):null})()]})]}),e.jsx(b,{className:"w-4 h-4 fill-amber-500 text-amber-500"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-base mb-1 line-clamp-1",children:s.title}),s.content&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.content})]}),e.jsx("div",{className:"flex items-center justify-between pt-1",children:e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(G,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{children:s.lanterns??0})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{children:s.comments??0})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"w-1 h-1 rounded-full bg-muted-foreground/60 inline-block"}),e.jsxs("span",{children:[s.views??0," 조회"]})]})]})})]})})})},(s,r)=>{if(s.post.id!==r.post.id||s.post.title!==r.post.title||s.post.content!==r.post.content||s.post.author!==r.post.author||s.post.authorAvatar!==r.post.authorAvatar||s.authorProfile?.profileImage!==r.authorProfile?.profileImage||s.post.timeAgo!==r.post.timeAgo||s.post.category!==r.post.category||s.post.type!==r.post.type||s.post.lanterns!==r.post.lanterns||s.post.comments!==r.post.comments)return!1;const c=s.post.tags?.join(",")??"",n=r.post.tags?.join(",")??"";return c===n});export{Z as BookmarkScreen};
