import{r as t,j as s}from"./index-BJjkZhAE.js";import{u as Q,j as V,B as C,f as X,I as Y,C as Z,b as _,k as j,P as ee}from"./App-Cnx-z95_.js";import{S as se}from"./search-CuXXKiqy.js";import"./vendor-capacitor-Bm7NWSxP.js";import"./vendor-react-1wgkHQEd.js";import"./vendor-firebase-B8qz7irO.js";function ne({onBack:i,categories:L,activeCategory:I,activeSubCategory:S,onCategorySelect:o,posts:P,onPostSelect:g,userNickname:T="",userProfileImage:U="",currentTitle:A="",isPostLanterned:m,isBookmarked:u,onLanternToggle:p,onBookmarkToggle:b,formatTimeAgo:h,formatCreatedAt:x}){const[r,f]=t.useState(""),[n,v]=t.useState("category"),M=Q({key:`category-${n}`}),N=L.filter(e=>e.name.toLowerCase().includes(r.toLowerCase())||e.subCategories.some(a=>a.name.toLowerCase().includes(r.toLowerCase()))),d=P.filter(e=>e.title?.toLowerCase?.().includes(r.toLowerCase())||e.content?.toLowerCase?.().includes(r.toLowerCase())||e.author?.toLowerCase?.().includes(r.toLowerCase())||e.tags&&e.tags.some(a=>a.toLowerCase().includes(r.toLowerCase()))),k=t.useCallback(e=>{o(e,"전체"),i()},[o,i]),y=t.useCallback((e,a)=>{o(e,a),i()},[o,i]),z=t.useCallback(e=>{f(e.target.value)},[]),E=t.useCallback(()=>{v("category"),f("")},[]),R=t.useCallback(()=>{v("post"),f("")},[]),$=t.useCallback(e=>{g(e)},[g]),D=t.useCallback(e=>{const a=e.currentTarget.dataset.categoryId;a&&k(a)},[k]),F=t.useCallback(e=>{const a=e.currentTarget.dataset.categoryId,c=e.currentTarget.dataset.subCategoryId;a&&c&&y(a,c)},[y]),O=t.useCallback(e=>m?m(e):!1,[m]),B=t.useCallback(e=>u?u(e):!1,[u]),W=t.useCallback(e=>{p?.(e)},[p]),q=t.useCallback(e=>{b?.(e)},[b]),G=t.useCallback(e=>h?h(e):"",[h]),H=t.useCallback(e=>x?x(e):"",[x]),J=t.useMemo(()=>{const e=new Set;return d.forEach(a=>{typeof a?.authorUid=="string"&&a.authorUid.length>0&&e.add(a.authorUid)}),Array.from(e)},[d]),K=V(J);return s.jsxs("div",{className:"w-full h-full bg-background text-foreground flex flex-col",children:[s.jsx("header",{className:"bg-card/95 backdrop-blur-xl border-b border-border flex-shrink-0 safe-top",children:s.jsxs("div",{className:"px-4 py-3",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx(C,{variant:"ghost",size:"icon",onClick:i,children:s.jsx(X,{className:"w-5 h-5"})}),s.jsx("h1",{className:"font-medium",children:"카테고리 선택"})]}),s.jsxs("div",{className:"flex space-x-2 mb-3",children:[s.jsx(C,{variant:n==="category"?"default":"outline",size:"sm",onClick:E,className:"flex-1",children:"카테고리 검색"}),s.jsx(C,{variant:n==="post"?"default":"outline",size:"sm",onClick:R,className:"flex-1",children:"글 검색"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),s.jsx(Y,{type:"text",placeholder:n==="category"?"카테고리 검색...":"글 제목, 내용, 작성자 검색...",value:r,onChange:z,className:"pl-10 h-9"})]})]})}),n==="category"?s.jsx("div",{ref:M,className:"flex-1 scroll-container scrollbar-hide",children:s.jsxs("div",{className:"p-4 space-y-4",children:[N.map(e=>{const a=e.icon,c=I===e.id;return s.jsx(Z,{className:`transition-all list-optimized ${c?"ring-2 ring-primary":""}`,children:s.jsx(_,{className:"p-4",children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between cursor-pointer hover:bg-accent/50 p-3 rounded-md -m-2 touch-target","data-category-id":e.id,onClick:D,children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-primary/10 to-primary/20 flex items-center justify-center",children:s.jsx(a,{className:"w-5 h-5 text-primary"})}),s.jsx("div",{children:s.jsx("h3",{className:"font-medium",children:e.name})})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[c&&s.jsx(j,{variant:"default",className:"text-xs",children:"선택됨"}),s.jsx(j,{variant:"secondary",className:"text-xs tabular-nums",children:e.count})]})]}),e.id!=="전체"&&e.subCategories.length>1&&s.jsx("div",{className:"ml-4 space-y-2",children:s.jsx("div",{className:"border-l-2 border-border pl-4 space-y-2",children:e.subCategories.filter(l=>l.id!=="전체").filter(l=>r===""||l.name.toLowerCase().includes(r.toLowerCase())).map(l=>{const w=c&&S===l.id;return s.jsxs("div",{className:`flex items-center justify-between cursor-pointer hover:bg-accent/50 p-3 rounded-md transition-colors touch-target ${w?"bg-accent":""}`,"data-category-id":e.id,"data-sub-category-id":l.id,onClick:F,children:[s.jsx("div",{children:s.jsx("p",{className:"text-sm font-medium",children:l.name})}),s.jsx("div",{className:"flex items-center space-x-2",children:w&&s.jsx(j,{variant:"default",className:"text-xs",children:"선택됨"})})]},l.id)})})})]})})},e.id)}),N.length===0&&r&&s.jsx("div",{className:"text-center py-8",children:s.jsx("p",{className:"text-muted-foreground",children:"검색된 카테고리가 없습니다."})})]})}):s.jsx("div",{className:"flex-1 overflow-hidden bg-background",children:d.length>0?s.jsx(ee,{posts:d,userNickname:T,userProfileImage:U,isPostLanterned:O,isBookmarked:B,currentTitle:A,userProfiles:K,formatTimeAgo:G,formatCreatedAt:H,onPostClick:$,onLanternToggle:W,onBookmarkToggle:q}):r?s.jsx("div",{className:"h-full flex items-center justify-center p-4",children:s.jsx("p",{className:"text-muted-foreground",children:"검색된 글이 없습니다."})}):s.jsx("div",{className:"h-full flex items-center justify-center p-4",children:s.jsx("p",{className:"text-muted-foreground",children:"검색어를 입력해주세요."})})})]})}export{ne as CategoryScreen};
