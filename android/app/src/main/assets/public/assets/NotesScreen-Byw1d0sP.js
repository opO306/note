import{R as t,b as g,d as j,j as e}from"./index-BJjkZhAE.js";import{Q as y,S as N,U as v,V as k,W as w,X as S}from"./vendor-firebase-B8qz7irO.js";import{r as C,E as R,N as E}from"./App-Cnx-z95_.js";import"./vendor-capacitor-Bm7NWSxP.js";import"./vendor-react-1wgkHQEd.js";function H({onBack:l,onOpenNote:d}){const[s,i]=t.useState([]),[r,c]=t.useState(!0),[o,m]=t.useState(null),[f,u]=t.useState(!1),n=t.useCallback(async()=>{const a=g.currentUser?.uid;if(!a){i([]),m("로그인 후 사용할 수 있어요."),c(!1),u(!1);return}try{const x=y(N(j,"notes"),v("uid","==",a),k("updatedAt","desc"),w(50)),h=(await S(x)).docs.map(p=>({id:p.id,...p.data()}));i(h),m(null)}catch(x){m(x?.message||"노트를 불러오지 못했어요.")}finally{c(!1),u(!1)}},[]);t.useEffect(()=>{n()},[n]);const b=t.useCallback(()=>{u(!0),c(!1),n()},[n]);return e.jsxs("div",{className:"w-full h-full bg-background text-foreground flex flex-col",children:[e.jsx(C,{title:"내 노트",subtitle:"질문 정리/학습 내용을 저장해둔 곳",onBack:l}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-4 pb-24 safe-bottom",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 text-xs text-muted-foreground",children:[e.jsx("span",{children:r?"노트를 불러오는 중이에요...":o?"노트를 불러오지 못했어요.":`${s.length}개의 노트`}),!r&&e.jsx("button",{type:"button",onClick:b,disabled:f,className:"inline-flex items-center gap-1 px-2 py-1 rounded-full border border-border text-[11px] hover:bg-accent/60 disabled:opacity-60",children:f?"새로고침 중...":"새로고침"})]}),r&&e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"text-sm text-muted-foreground",children:"불러오는 중..."})}),!r&&o&&e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"text-sm text-red-500",children:o})}),!r&&!o&&s.length===0&&e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx(R,{icon:e.jsx(E,{className:"w-16 h-16 text-primary"}),title:"저장된 노트가 없어요",description:"질문 정리 화면에서 “노트로 저장”을 눌러두면, 여기에서 언제든 다시 볼 수 있어요.",glowClassName:"bg-primary/25 dark:bg-primary/30",circleClassName:"bg-primary/10 dark:bg-primary/20 border-4 border-primary/40"})}),!r&&!o&&s.length>0&&e.jsx("div",{className:"space-y-3 pb-4",children:s.map(a=>e.jsx(A,{note:a,onClick:()=>d(a.id)},a.id))})]})]})}function A({note:l,onClick:d}){const s=(l.body||"").replace(/\s+/g," ").slice(0,120),i=l.updatedAt?.toDate?.();return e.jsxs("button",{type:"button",onClick:d,className:"w-full text-left rounded-2xl border border-border bg-card/90 px-4 py-3",children:[e.jsx("div",{className:"text-sm font-semibold truncate",children:l.title||"(제목 없음)"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:s||"내용이 비어있어요."}),e.jsx("div",{className:"text-[11px] text-muted-foreground mt-2",children:i?`수정: ${i.toLocaleString()}`:""})]})}export{H as default};
