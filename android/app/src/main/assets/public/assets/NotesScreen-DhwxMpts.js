import{R as t,a as g,d as j,j as e}from"./index-nq_z7WhA.js";import{J as y,I as N,R as v,M as k,K as w,O as C}from"./vendor-firebase-D1NEqzdz.js";import{A as R,v as S,N as A}from"./MainScreenRefactored-BRHyWOom.js";import"./vendor-capacitor-rvH5hiNU.js";import"./vendor-react-1wgkHQEd.js";import"./toastHelper-BQ6M3Cc4.js";import"./App-COUbzzsB.js";import"./card-DIbA5A_d.js";import"./index-Bjta6Ul0.js";import"./index-C-WI9JZT.js";import"./checkbox-CFUi8qYh.js";import"./check-FzTHNnAz.js";import"./avatar-CGdV8c0F.js";import"./alert-dialog-simple-C5oUXbYo.js";import"./sparkles-7iSHoCyd.js";import"./firebaseCache-C_csZa1c.js";import"./profanityFilter-CmEWjjlv.js";import"./arrow-left-Lp9IH1tN.js";import"./users-CgQI8rwE.js";import"./sun-BhpYpMxp.js";function Y({onBack:i,onOpenNote:d}){const[s,l]=t.useState([]),[r,c]=t.useState(!0),[o,m]=t.useState(null),[x,p]=t.useState(!1),n=t.useCallback(async()=>{const a=g.currentUser?.uid;if(!a){l([]),m("로그인 후 사용할 수 있어요."),c(!1),p(!1);return}try{const u=y(N(j,"notes"),v("uid","==",a),k("updatedAt","desc"),w(50)),h=(await C(u)).docs.map(f=>({id:f.id,...f.data()}));l(h),m(null)}catch(u){m(u?.message||"노트를 불러오지 못했어요.")}finally{c(!1),p(!1)}},[]);t.useEffect(()=>{n()},[n]);const b=t.useCallback(()=>{p(!0),c(!1),n()},[n]);return e.jsxs("div",{className:"w-full h-full bg-background text-foreground flex flex-col",children:[e.jsx(R,{title:"내 노트",subtitle:"질문 정리/학습 내용을 저장해둔 곳",onBack:i}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-4 pb-24 safe-bottom",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 text-xs text-muted-foreground",children:[e.jsx("span",{children:r?"노트를 불러오는 중이에요...":o?"노트를 불러오지 못했어요.":`${s.length}개의 노트`}),!r&&e.jsx("button",{type:"button",onClick:b,disabled:x,className:"inline-flex items-center gap-1 px-2 py-1 rounded-full border border-border text-[11px] hover:bg-accent/60 disabled:opacity-60",children:x?"새로고침 중...":"새로고침"})]}),r&&e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"text-sm text-muted-foreground",children:"불러오는 중..."})}),!r&&o&&e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"text-sm text-red-500",children:o})}),!r&&!o&&s.length===0&&e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx(S,{icon:e.jsx(A,{className:"w-16 h-16 text-primary"}),title:"저장된 노트가 없어요",description:"질문 정리 화면에서 “노트로 저장”을 눌러두면, 여기에서 언제든 다시 볼 수 있어요.",glowClassName:"bg-primary/25 dark:bg-primary/30",circleClassName:"bg-primary/10 dark:bg-primary/20 border-4 border-primary/40"})}),!r&&!o&&s.length>0&&e.jsx("div",{className:"space-y-3 pb-4",children:s.map(a=>e.jsx(E,{note:a,onClick:()=>d(a.id)},a.id))})]})]})}function E({note:i,onClick:d}){const s=(i.body||"").replace(/\s+/g," ").slice(0,120),l=i.updatedAt?.toDate?.();return e.jsxs("button",{type:"button",onClick:d,className:"w-full text-left rounded-2xl border border-border bg-card/90 px-4 py-3",children:[e.jsx("div",{className:"text-sm font-semibold truncate",children:i.title||"(제목 없음)"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:s||"내용이 비어있어요."}),e.jsx("div",{className:"text-[11px] text-muted-foreground mt-2",children:l?`수정: ${l.toLocaleString()}`:""})]})}export{Y as default};
