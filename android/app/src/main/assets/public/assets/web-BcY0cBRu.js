import{l as r,m as i,n as a,o as s,p as l,q as c}from"./index-BJjkZhAE.js";import{W as k,_ as u}from"./vendor-capacitor-Bm7NWSxP.js";import{ac as C}from"./vendor-firebase-B8qz7irO.js";import"./vendor-react-1wgkHQEd.js";const g=Object.freeze(Object.defineProperty({__proto__:null,ReCaptchaEnterpriseProvider:l,ReCaptchaV3Provider:c,getToken:r,initializeAppCheck:i,onTokenChanged:s,setTokenAutoRefreshEnabled:a},Symbol.toStringTag,{value:"Module"}));class n extends k{get appCheckInstance(){return this._appCheckInstance}set appCheckInstance(e){this._appCheckInstance=e,e?this.registerOnTokenChangedListener():this.unregisterOnTokenChangedListener()}async getToken(e){if(!this.appCheckInstance)throw new Error(n.errorNotInitialized);return{token:(await r(this.appCheckInstance,e?.forceRefresh)).token}}async initialize(e){e?.debugToken?self.FIREBASE_APPCHECK_DEBUG_TOKEN=e.debugToken:e?.debug&&(self.FIREBASE_APPCHECK_DEBUG_TOKEN=!0);let t=e?.provider;if(!t){if(!e?.siteKey)throw new Error(n.errorSiteKeyMissing);const{ReCaptchaV3Provider:d}=await u(async()=>{const{ReCaptchaV3Provider:h}=await Promise.resolve().then(()=>g);return{ReCaptchaV3Provider:h}},void 0,import.meta.url);t=new d(e?.siteKey)}const o=C();this.appCheckInstance=i(o,{provider:t,isTokenAutoRefreshEnabled:e?.isTokenAutoRefreshEnabled})}async setTokenAutoRefreshEnabled(e){if(!this.appCheckInstance)throw new Error(n.errorNotInitialized);a(this.appCheckInstance,e.enabled)}registerOnTokenChangedListener(){this.appCheckInstance&&(this.onTokenChangedListenerUnsubscribe=s(this.appCheckInstance,e=>this.handleTokenChanged(e.token)))}unregisterOnTokenChangedListener(){this.onTokenChangedListenerUnsubscribe&&this.onTokenChangedListenerUnsubscribe()}handleTokenChanged(e){const t={token:e};this.notifyListeners(n.tokenChangedEvent,t)}}n.tokenChangedEvent="tokenChanged";n.errorNotInitialized="AppCheck has not been initialized.";n.errorSiteKeyMissing="siteKey must be provided.";export{n as FirebaseAppCheckWeb};
