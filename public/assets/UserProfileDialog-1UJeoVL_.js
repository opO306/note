import{r as l,j as e}from"./vendor-radix-common-Lw-R5L56.js";import{t as O,A as U,O as F,F as $,j as H,M as _,C as n,i as c,L as P,G as be,H as pe,J as G,N as J,B as Ne}from"./index-zqdvtYl2.js";import{FollowListScreen as K}from"./FollowListScreen-D3oJ7Oax.js";import{y as V,aa as ve,x as we,U as ke,z as q,c as R,m as Ce,I as ye,b as Ae}from"./vendor-icons-B8UqI-Qt.js";import"./vendor-react-BjpLs-I5.js";import"./vendor-utils-NdZ4-hto.js";import"./vendor-radix-extra-SjO53O2I.js";function Te(t){return t<=10?"text-red-400":t<=30?"text-orange-400":t<=70?"text-emerald-400":"text-blue-400"}function Pe(t){return t<=10?"질문·답변 활동이 아직 적거나, 신고 이력이 있어 낮게 책정된 상태예요.":t<=30?"기본 수준의 신뢰도예요. 꾸준히 좋은 질문과 답변을 남기면 점수가 올라가요.":t<=70?"안정적인 신뢰도예요. 다른 사용자에게 도움을 꽤 많이 주고 있어요.":"매우 높은 신뢰도예요. 많은 사용자들에게 신뢰를 받고 있는 계정입니다."}function E(t){return t?t instanceof Date?t.toLocaleString("ko-KR"):String(t):""}function Ie({onBack:t,userName:f,userAvatar:Q,username:j,userBio:L,posts:u=[],trustScore:S=30,reportCount:z=0,achievementCount:W=0,titleCount:X=0,guideCount:Y=0,followerCount:Z=0,followingCount:ee=0,followerUsers:se=[],followingUsers:te=[],onPostClick:b,onReplyClick:p,isMyself:y=!1,isFollowing:N=!1,onToggleFollowUser:v,onFollowUserClick:B,activeSection:ae,onChangeSection:le}){const x=j||f||"사용자",re=x===$,[ne,ce]=l.useState("profile"),w=ae??ne,i=le??ce,k=l.useCallback(()=>{i("profile")},[i]),ie=l.useCallback(()=>{i("followers")},[i]),de=l.useCallback(()=>{i("following")},[i]),oe=l.useCallback(()=>{i("posts")},[i]),xe=l.useCallback(()=>{i("replies")},[i]),A=l.useMemo(()=>Math.max(0,Math.min(100,S)),[S]),me=Te(A),ue=Pe(A),s=l.useMemo(()=>{const h=u.length;let m=0,o=0,g=null;u.forEach(a=>{const C=a.lanterns??0,d=a.comments??(Array.isArray(a.replies)?a.replies.length:0);m+=C,o+=d,(!g||C>g.lanterns)&&(g={id:a.id,title:a.title,lanterns:C,comments:d,category:a.category,timeAgo:E(a.timeAgo||a.createdAtText||a.createdAt||"")})});let r=null;const I=j||f;return u.forEach(a=>{(a.replies??[]).forEach(d=>{if(!I||d.author!==I)return;const M=d.lanterns??0;(!r||M>r.lanterns)&&(r={id:d.id,content:d.content,lanterns:M,timeAgo:E(d.timeAgo||d.createdAtText||d.createdAt||""),postTitle:a.title,postId:a.id})})}),{nickname:x,totalPosts:h,totalLanterns:m,totalComments:o,bio:L||"깊이 있는 학습을 추구하는 탐구자입니다.",bestPost:g,bestReply:r}},[x,u,j,f,L]),he=l.useMemo(()=>{const h=[],m=j||f;return u.forEach(o=>{(o.replies??[]).forEach(r=>{!m||r.author!==m||h.push({id:r.id,postId:o.id,postAuthor:o.author||o.nickname||o.userName||"질문 작성자",postTitle:o.title,content:r.content,lanterns:r.lanterns??0,timeAgo:E(r.timeAgo||r.createdAtText||r.createdAt||"")})})}),h},[u,j,f]),fe=l.useCallback(()=>{b&&s.bestPost?.id!=null&&b(s.bestPost.id)},[b,s]),je=l.useCallback(()=>{p&&s.bestReply?.postId!=null&&s.bestReply?.id!=null&&p(s.bestReply.postId,s.bestReply.id)},[p,s]),[T,D]=l.useState(!1),ge=l.useCallback(async()=>{if(!v||y||T)return;const h=N?"하선":"승선";D(!0);try{await Promise.resolve(v(x))===!0&&O.success(`${h}이 완료되었습니다.`)}catch(m){console.error("팔로우 토글 실패:",m),O.error(`${h}에 실패했습니다. 잠시 후 다시 시도해주세요.`)}finally{D(!1)}},[v,y,x,T,N]);return re?e.jsxs("div",{className:"w-full h-full bg-background text-foreground flex flex-col overflow-hidden",children:[e.jsx(U,{title:"사용자 프로필",onBack:t}),e.jsx("main",{className:"flex-1 flex items-center justify-center px-4",children:e.jsxs("div",{className:"w-full max-w-sm mx-auto text-center space-y-4",children:[e.jsx(F,{src:void 0,alt:x,size:64,fallbackText:"탈퇴"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-base",children:$}),e.jsx("p",{className:"text-xs text-muted-foreground leading-snug",children:"탈퇴한 계정입니다. 더 이상 프로필, 작성 글, 답글을 볼 수 없어요."})]}),e.jsx(H,{size:"sm",className:"mt-2",onClick:t,children:"닫기"})]})})]}):w==="followers"?e.jsx("div",{className:"w-full h-full bg-background text-foreground flex flex-col overflow-hidden",children:e.jsx(K,{mode:"followers",users:se,onBack:k,onUserClick:B})}):w==="following"?e.jsx("div",{className:"w-full h-full bg-background text-foreground flex flex-col overflow-hidden",children:e.jsx(K,{mode:"following",users:te,onBack:k,onUserClick:B})}):w==="posts"?e.jsx("div",{className:"w-full h-full bg-background text-foreground flex flex-col overflow-hidden",children:e.jsx(_,{mode:"posts",posts:u,onBack:k,onPostClick:b})}):w==="replies"?e.jsx("div",{className:"w-full h-full bg-background text-foreground flex flex-col overflow-hidden",children:e.jsx(_,{mode:"replies",replies:he,onBack:k,onReplyClick:p})}):e.jsxs("div",{className:"w-full h-full bg-background text-foreground flex flex-col overflow-hidden",children:[e.jsx(U,{title:"사용자 프로필",onBack:t}),e.jsx("main",{className:"flex-1 scroll-container scrollbar-hide",children:e.jsxs("div",{className:"w-full max-w-md sm:max-w-lg md:max-w-2xl lg:max-w-3xl xl:max-w-4xl mx-auto p-4 space-y-4",children:[e.jsx(n,{className:"border-border/70 shadow-sm rounded-xl",children:e.jsxs(c,{className:"p-4 flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx(F,{src:Q,alt:x,size:64,fallbackText:x.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex flex-col gap-1 flex-1",children:[e.jsx("h3",{className:"font-semibold text-base",children:s.nickname}),e.jsx("p",{className:"text-xs text-muted-foreground leading-snug",children:s.bio})]})]}),!y&&v&&e.jsx("div",{className:"flex flex-col items-end gap-2",children:e.jsx(H,{size:"sm",className:"h-8 px-3 rounded-full text-xs",variant:N?"outline":"default",onClick:ge,disabled:T,children:N?e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"w-3 h-3 mr-1"}),"하선하기"]}):e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"w-3 h-3 mr-1"}),"승선하기"]})})})]})}),e.jsx(n,{className:"border-border/70 shadow-sm rounded-xl",children:e.jsxs(c,{className:"p-4 flex flex-col items-center text-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm font-medium",children:["신뢰도"," ",e.jsxs("span",{className:`font-semibold ${me}`,children:[Math.round(A),"점"]})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground leading-snug",children:ue}),z>0&&e.jsxs("p",{className:"text-[11px] text-muted-foreground",children:["최근 신고 ",z,"회가 신뢰도 계산에 함께 반영되어 있습니다."]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(n,{className:"cursor-pointer",onClick:ie,children:e.jsxs(c,{className:"p-4 text-center",children:[e.jsx(ke,{className:"w-6 h-6 mx-auto mb-2 text-amber-500"}),e.jsx("div",{className:"text-lg font-medium",children:Z}),e.jsx("div",{className:"text-xs text-muted-foreground leading-snug",children:"선원"})]})}),e.jsx(n,{className:"cursor-pointer",onClick:de,children:e.jsxs(c,{className:"p-4 text-center",children:[e.jsx(V,{className:"w-6 h-6 mx-auto mb-2 text-amber-500"}),e.jsx("div",{className:"text-lg font-medium",children:ee}),e.jsx("div",{className:"text-xs text-muted-foreground leading-snug",children:"승선한 배"})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(n,{className:"cursor-pointer",onClick:oe,children:e.jsxs(c,{className:"p-4 text-center",children:[e.jsx(q,{className:"w-6 h-6 mx-auto mb-2 text-blue-500"}),e.jsx("div",{className:"text-lg font-medium",children:s.totalPosts}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"작성한 글"})]})}),e.jsx(n,{className:"cursor-pointer",onClick:xe,children:e.jsxs(c,{className:"p-4 text-center",children:[e.jsx(R,{className:"w-6 h-6 mx-auto mb-2 text-green-500"}),e.jsx("div",{className:"text-lg font-medium",children:s.totalComments}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"답글"})]})}),e.jsx(n,{children:e.jsxs(c,{className:"p-4 text-center",children:[e.jsx(Ce,{className:"w-6 h-6 mx-auto mb-2 text-amber-500"}),e.jsx("div",{className:"text-lg font-medium",children:W}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"달성한 업적"})]})}),e.jsx(n,{children:e.jsxs(c,{className:"p-4 text-center",children:[e.jsx(ye,{className:"w-6 h-6 mx-auto mb-2 text-purple-500"}),e.jsx("div",{className:"text-lg font-medium",children:X}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"보유 칭호"})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(n,{children:e.jsxs(c,{className:"p-4 text-center",children:[e.jsx(P,{className:"w-6 h-6 mx-auto mb-2 text-amber-500"}),e.jsx("div",{className:"text-lg font-medium",children:s.totalLanterns}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"받은 등불"})]})}),e.jsx(n,{children:e.jsxs(c,{className:"p-4 text-center",children:[e.jsx(Ae,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-lg font-medium",children:Y}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"길잡이 횟수"})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsxs(be,{defaultValue:"bestPost",className:"w-full",children:[e.jsxs(pe,{className:"grid w-full grid-cols-2 gap-2 bg-transparent p-0 border-0",children:[e.jsxs(G,{value:"bestPost",className:`\r
                    text-xs rounded-xl border border-border/70 bg-card/60\r
                    flex items-center justify-center gap-1 py-2\r
                    data-[state=active]:bg-card\r
                    data-[state=active]:text-foreground\r
                    data-[state=active]:shadow-sm\r
                  `,children:[e.jsx(q,{className:"w-4 h-4"}),e.jsx("span",{children:"인기 글"})]}),e.jsxs(G,{value:"bestReply",className:`\r
                    text-xs rounded-xl border border-border/70 bg-card/60\r
                    flex items-center justify-center gap-1 py-2\r
                    data-[state=active]:bg-card\r
                    data-[state=active]:text-foreground\r
                    data-[state=active]:shadow-sm\r
                  `,children:[e.jsx(R,{className:"w-4 h-4"}),e.jsx("span",{children:"인기 답변"})]})]}),e.jsx(J,{value:"bestPost",className:"mt-4 border-t border-border pt-4",children:s.bestPost?e.jsx(n,{className:"hover:shadow-md transition-shadow cursor-pointer list-optimized",onClick:fe,children:e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Ne,{variant:"outline",className:"text-xs",children:s.bestPost.category}),s.bestPost.timeAgo&&e.jsx("span",{className:"text-xs text-muted-foreground",children:s.bestPost.timeAgo})]}),e.jsx("h3",{className:"font-medium text-sm line-clamp-1",children:s.bestPost.title}),e.jsxs("div",{className:"flex items-center space-x-3 pt-2 border-t border-border",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(P,{className:"w-3 h-3 text-amber-500"}),e.jsx("span",{className:"text-xs text-amber-600",children:s.bestPost.lanterns})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(R,{className:"w-3 h-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.bestPost.comments})]})]})]})})}):e.jsx("div",{className:"py-10 flex justify-center",children:e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"아직 인기 글이 없습니다."})})}),e.jsx(J,{value:"bestReply",className:"mt-4 border-t border-border pt-4",children:s.bestReply?e.jsx(n,{className:"hover:shadow-md transition-shadow list-optimized cursor-pointer",onClick:je,children:e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"space-y-2",children:[s.bestReply.postTitle&&e.jsx("p",{className:"text-[11px] text-muted-foreground line-clamp-1",children:s.bestReply.postTitle}),e.jsx("p",{className:"text-sm line-clamp-2",children:s.bestReply.content}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-border",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(P,{className:"w-3 h-3 text-amber-500"}),e.jsx("span",{className:"text-xs text-amber-600",children:s.bestReply.lanterns})]}),s.bestReply.timeAgo&&e.jsx("span",{className:"text-xs text-muted-foreground",children:s.bestReply.timeAgo})]})]})})}):e.jsx("div",{className:"py-10 flex justify센터",children:e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"아직 인기 답변이 없습니다."})})})]})})]})})]})}export{Ie as UserProfileDialog};
