#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
MainScreen.tsx 한글 깨짐 자동 수정 스크립트
"""

# 깨진 한글 → 올바른 한글 매핑 테이블
MAPPING = {
    # 기본 단어들
    "ì „ì²´": "전체",
    "ê³µí•™": "공학",
    "ê³¼í•™": "과학",
    "ìˆ˜í•™": "수학",
    "ê¸¸ìž¡ì´": "길잡이",
    "ê¿ˆë‚˜ë¬´": "꿈나무",
    "ê¼¬ë§ˆ": "꼬마",
    "í‰ë²"í•œ": "평범한",
    "ì¹œì ˆí•œ": "친절한",
    "ìœ ëª…í•œ": "유명한",
    "ìŠ¤ìŠ¹": "스승",
    "ì„¸ë¥´íŒŒ": "세르파",
    "ë¶ˆë©¸ì˜": "불멸의",
    "ë"±ë¶ˆ": "등불",
    "ì¹­í˜¸": "칭호",
    "ì •ë³´": "정보",
    "í'œì‹œ": "표시",
    "í•¨ìˆ˜": "함수",
    "ë‹¤ë¥¸": "다른",
    "ì‚¬ìš©ìž": "사용자",
    "ê¸°ë³¸ê°'": "기본값",
    "ì‚¬ìš©": "사용",
    
    # 카테고리
    "ì†Œí"„íŠ¸ì›¨ì–´": "소프트웨어",
    "ê¸°ê³„ê³µí•™": "기계공학",
    "ì „ìžê³µí•™": "전자공학",
    "ê±´ì¶•ê³µí•™": "건축공학",
    "ë¬¼ë¦¬í•™": "물리학",
    "í™"í•™": "화학",
    "ìƒë¬¼í•™": "생물학",
    "ì§€êµ¬ê³¼í•™": "지구과학",
    "ì²œë¬¸í•™": "천문학",
    "ëŒ€ìˆ˜í•™": "대수학",
    "ê¸°í•˜í•™": "기하학",
    "í•´ì„í•™": "해석학",
    
    # 문장들
    "ê¸€ì—ì„œ ë°›ì€ ë"±ë¶ˆ": "글에서 받은 등불",
    "í'œì‹œìš©": "표시용",
    "ë‹µê¸€ì—ì„œ ë°›ì€ ë"±ë¶ˆ": "답글에서 받은 등불",
    "ê¸¸ìž¡ì´ ì±„íƒ ë°›ì€ íšŸìˆ˜": "길잡이 채택 받은 횟수",
    "ì´ë¯¸ ë³´ìƒë°›ì€ ë§ˆì¼ìŠ¤í†¤": "이미 보상받은 마일스톤",
    "ë³´ìœ í•œ ì¹­í˜¸ë"¤": "보유한 칭호들",
    "í˜„ìž¬ ìž¥ì°©í•œ ì¹­í˜¸": "현재 장착한 칭호",
    "ê¸¸ìž¡ì´ë¡œ ì±„íƒëœ ë‹µê¸€ë"¤": "길잡이로 채택된 답글들",
    "ê° í¬ìŠ¤íŠ¸ë³„ë¡œ ì„ íƒëœ ê¸¸ìž¡ì´ ë‹µê¸€": "각 포스트별로 선택된 길잡이 답글",
    "ë„¤ë¹„ê²Œì´ì…˜ í•¸ë"¤ëŸ¬ í•¨ìˆ˜ë"¤": "네비게이션 핸들러 함수들",
    "ì¹­í˜¸ í'œì‹œ í•¨ìˆ˜": "칭호 표시 함수",
    
    # UI 텍스트
    "ì•„ì§ ê¸€ì´ ì—†ì–´ìš"": "아직 글이 없어요",
    "ì²« ë²ˆì§¸ ê¸€ì„ ìž'ì„±í•´ì„œ ë¹„ìœ ë…¸íŠ¸ ì»¤ë®¤ë‹ˆí‹°ë¥¼ ì‹œìž'í•´ë³´ì„¸ìš"!": "첫 번째 글을 작성해서 비유노트 커뮤니티를 시작해보세요!",
    "ì²« ê¸€ ìž'ì„±í•˜ê¸°": "첫 글 작성하기",
    "ê¸¸ìž¡ì´ê¸€ë§Œ ë"±ë¶ˆ í'œì‹œ": "길잡이글만 등불 표시",
    "ëžœí„´ ì•„ì´ì½˜ with ê¸€ë¡œìš° íš¨ê³¼": "랜턴 아이콘 with 글로우 효과",
    "ê²Œì‹œê¸€": "게시글",
    "ë‹µê¸€": "답글",
    "ìž'ì„± ì „ í™•ì¸": "작성 전 확인",
    "ê²Œì‹œê¸€ ìž'ì„± 30ë¶„ í›„ ë¶€í„°ëŠ" ì‚­ì œ ë¶ˆê°€": "게시글 작성 30분 후 부터는 삭제 불가",
    "í™•ì¸": "확인",
    "ë‹¤ì‹œ ë³´ì§€ ì•Šê¸°": "다시 보지 않기",
    
    # 특수문자
    "â­": "⭐",
    "ì´ ì¤„ë"¤ì„ ì¶"ê°€í•˜ì„¸ìš"": "이 줄들을 추가하세요",
}

def fix_korean_encoding(input_file, output_file):
    """깨진 한글을 수정하는 함수"""
    try:
        with open(input_file, 'r', encoding='utf-8', errors='ignore') as f:
            content = f.read()
        
        # 매핑 테이블 적용
        for broken, fixed in MAPPING.items():
            content = content.replace(broken, fixed)
        
        # 수정된 내용 저장
        with open(output_file, 'w', encoding='utf-8') as f:
            f.write(content)
        
        print(f"✅ 수정 완료!")
        print(f"입력: {input_file}")
        print(f"출력: {output_file}")
        return True
        
    except Exception as e:
        print(f"❌ 오류 발생: {e}")
        return False

if __name__ == "__main__":
    import sys
    
    if len(sys.argv) != 3:
        print("사용법: python fix_korean.py <입력파일> <출력파일>")
        print("예시: python fix_korean.py MainScreen.tsx MainScreen_fixed.tsx")
        sys.exit(1)
    
    input_file = sys.argv[1]
    output_file = sys.argv[2]
    
    fix_korean_encoding(input_file, output_file)
